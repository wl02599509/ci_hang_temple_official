## 新增需求

### 需求:匯出按鈕可用性
系統應在管理後台人員列表頁面顯示匯出按鈕,供已驗證的管理員存取。

#### 情境:已驗證的管理員可看到匯出按鈕
- **當** 已驗證的管理員查看管理後台人員列表頁面時
- **則** 系統顯示「匯出」按鈕或表單

#### 情境:未驗證的使用者無法存取匯出按鈕
- **當** 未驗證的使用者嘗試存取匯出功能時
- **則** 系統重導向至登入頁面

### 需求:固定欄位匯出
系統應以預定義順序匯出所有可用的人員欄位。

#### 情境:匯出包含所有欄位
- **當** 管理員發起匯出時
- **則** 系統以預定義順序匯出所有可用欄位(status、name、id_number、sex、birth_date、zodiac、address、email)

### 需求:篩選整合
系統在匯出人員記錄時應遵循目前的 Ransack 搜尋和篩選參數。

#### 情境:匯出篩選結果
- **當** 管理員套用搜尋篩選器(例如,依姓名或狀態搜尋)時
- **則** 系統僅匯出符合目前篩選條件的人員

#### 情境:無篩選匯出
- **當** 管理員在未套用任何篩選器的情況下匯出時
- **則** 系統匯出所有人員記錄

#### 情境:使用多重篩選器匯出
- **當** 管理員套用多個篩選器(例如,狀態 AND 日期範圍)時
- **則** 系統匯出符合所有有效篩選條件的人員

### 需求:Excel 檔案生成
系統應生成包含匯出人員資料的有效 Excel (.xlsx) 檔案。

#### 情境:成功生成 Excel
- **當** 管理員請求匯出時
- **則** 系統生成具有適當 Excel 格式的可下載 .xlsx 檔案

#### 情境:Excel 檔案有標題
- **當** Excel 檔案被生成時
- **則** 第一列包含使用 `User.human_attribute_name` 的本地化欄位標題

#### 情境:Excel 檔案有資料列
- **當** Excel 檔案與人員記錄一起生成時
- **則** 每個後續列以正確順序包含所有欄位的人員資料

#### 情境:Excel 檔案命名
- **當** Excel 檔案被下載時
- **則** 檔案名稱遵循 I18n 組態中定義的格式(人員資料)

### 需求:資料準確性
系統應確保匯出的資料與資料庫中人員記錄的目前狀態相符。

#### 情境:匯出反映目前資料
- **當** 管理員匯出人員記錄時
- **則** Excel 檔案包含來自資料庫的最新資料

#### 情境:列舉值正確匯出
- **當** Excel 檔案包含列舉欄位(status、sex、zodiac)時
- **則** 系統匯出人類可讀的值或適當的表示法

### 需求:匯出效能
系統應在合理的時間範圍內同步完成一般資料集的匯出。

#### 情境:一般資料集的匯出完成
- **當** 管理員匯出最多 1000 筆人員記錄時
- **則** 系統在 5 秒內生成檔案並啟動下載

#### 情境:匯出不逾時
- **當** 管理員匯出篩選後的人員記錄時
- **則** 系統完成匯出且不會發生請求逾時錯誤

### 需求:安全性和授權
系統應對所有匯出操作強制執行身分驗證和授權。

#### 情境:已驗證的使用者可以匯出
- **當** 已驗證的管理員存取匯出端點時
- **則** 系統處理匯出請求

#### 情境:未驗證的請求被拒絕
- **當** 未驗證的請求發送至匯出端點時
- **則** 系統返回 401 未授權或重導向至登入頁面

#### 情境:匯出遵循使用者權限
- **當** 匯出功能被存取時
- **則** 系統在處理前驗證使用者具有管理員權限
